<!doctype html>

<html>

<head>
  <script>
    var waiting = false;

    var unsorted = [8, 17, 1, 2, 9, 100, 4, 3];
    var sorted = [];

    var x;
    var m;
    var n;
    var k;

    var a;
    var b;

    var cmp;

    function selectLeft() {
      if (waiting) {
        waiting = false;
        cmp = 1;
        continue_search();
      }
    }

    function selectRight() {
      if (waiting) {
        waiting = false;
        cmp = -1;
        continue_search();
      }
    }

    function continue_search() {
      if (cmp > 0) {
        m = k + 1;
        return binarySearch();
      } else if (cmp < 0) {
        n = k - 1;
        return binarySearch();
      } else {
        sorted.splice(k, 0, x);
        sort_next();
      }
    }

    function binarySearch() {
      if (m <= n) {
        k = (n + m) >> 1;
        a = x;
        b = sorted[k];

        var text = document.getElementById("comparison");
        text.innerHTML = "Is " + a + " greater than " + b + "?";
        waiting = true;
      } else {
        sorted.splice(m, 0, x);
        sort_next();
      }
    }

    function pop_random() {
      return unsorted.splice(Math.floor(Math.random() * unsorted.length), 1)[0];
    }

    function sort_next() {
      if (unsorted.length > 0) {
        x = pop_random();
        m = 0;
        n = sorted.length - 1;
        binarySearch();
      } else {
        console.log(sorted);
      }
    }

    function start_sort() {
      sort_next();
    }
  </script>
</head>

<body onload="start_sort()">
  <p id="comparison"></p>
  <input id="left" type='submit' value='left' onClick="selectLeft()" />
  <input id="right" type='submit' value='right' onClick="selectRight()" />
</body>

</html>